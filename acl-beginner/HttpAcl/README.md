# HTTP Module ACL: HTTP μ„λ²„

## λ©μ°¨

1. [κΈ°λ³Έ Sample μ½”λ“: `http_ex.cpp` λ¶„μ„](#κΈ°λ³Έ-sample-μ½”λ“-http_excpp-λ¶„μ„)
2. [μ½”λ“ κµ¬μ„± μ”μ†](#μ½”λ“-κµ¬μ„±-μ”μ†)
    - ν—¤λ” νμΌ ν¬ν•¨
    - μ„¤μ • λ³€μ μ΄κΈ°ν™”
    - μ„λ²„ μ΄κΈ°ν™”
3. [μ΄λ²¤νΈ ν•Έλ“¤λ¬ μ„¤μ •](#μ΄λ²¤νΈ-ν•Έλ“¤λ¬-μ„¤μ •)
4. [HTTP μ”μ²­ μ²λ¦¬ ν•Έλ“¤λ¬](#http-μ”μ²­-μ²λ¦¬-ν•Έλ“¤λ¬)
5. [μ„λ²„ μ‹¤ν–‰](#μ„λ²„-μ‹¤ν–‰)
6. [λΉ„λ™κΈ° μ²λ¦¬ λ° μ½”λ£¨ν‹΄](#λΉ„λ™κΈ°-μ²λ¦¬-λ°-μ½”λ£¨ν‹΄)
    - [1. ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½ (`on_accept`)](#1-ν΄λΌμ΄μ–ΈνΈ-μ—°κ²°-μλ½-on_accept)
    - [2. HTTP μ”μ²­ μ²λ¦¬ (`http_servlet::doRun`)](#2-http-μ”μ²­-μ²λ¦¬-http_servletdorun)
    - [3. μ„λ²„ μ‹¤ν–‰ νλ¦„](#3-μ„λ²„-μ‹¤ν–‰-νλ¦„)
        - [3.1 `run_alone` ν•¨μ](#31-run_alone-ν•¨μ)
        - [3.2 `run` ν•¨μ](#32-run-ν•¨μ)
        - [3.3 `acl_fiber_server_main` ν•¨μ](#33-acl_fiber_server_main-ν•¨μ)
        - [3.4 ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½ (`service_on_accept` ν•¨μ)](#34-ν΄λΌμ΄μ–ΈνΈ-μ—°κ²°-μλ½-service_on_accept-ν•¨μ)
        - [3.5 ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ²λ¦¬ (`on_accept` ν•¨μ)](#35-ν΄λΌμ΄μ–ΈνΈ-μ—°κ²°-μ²λ¦¬-on_accept-ν•¨μ)
        - [3.6 HTTP μ”μ²­ μ²λ¦¬ (`http_servlet::doRun` ν•¨μ)](#36-http-μ”μ²­-μ²λ¦¬-http_servletdorun-ν•¨μ)
    - [4. λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ν•λ” μ„λ²„μ μ „μ²΄ νλ¦„ μ”μ•½](#4-λΉ„λ™κΈ°μ μΌλ΅-μ²λ¦¬ν•λ”-μ„λ²„μ-μ „μ²΄-νλ¦„-μ”μ•½)
7. [κ²°λ΅ ](#κ²°λ΅ )
8. [λ¦¬ν©ν† λ§](#λ¦¬ν©ν† λ§)
9. [μ°Έκ³  λ¬Έμ„](#μ°Έκ³ -λ¬Έμ„)


## ν”„λ΅μ νΈ κµ¬μ΅°

```
/HttpAcl
β”β”€β”€ http_ex.cpp           # κΈ°λ³Έ http μμ  νμΌ: μ•„λ λ μ΄μ–΄κ°€ ν•©μ³μ„ 1κ°μ νμΌμ— μ΅΄μ¬
β”‚
β”β”€β”€ http_controller.hpp   # Controller λ μ΄μ–΄: HTTP μ”μ²­μ„ μ²λ¦¬ν•κ³  μ„λΉ„μ¤ νΈμ¶
β”β”€β”€ http_service.hpp      # Service λ μ΄μ–΄: λΉ„μ¦λ‹μ¤ λ΅μ§ μ²λ¦¬
β”β”€β”€ http_model.hpp        # Model λ μ΄μ–΄: λ°μ΄ν„° κµ¬μ΅°μ™€ DB μ—°λ™ μ²λ¦¬
β”β”€β”€ main.cpp              # λ©”μΈ νμΌ: μ„λ²„ μ„¤μ • λ° μ‹¤ν–‰
β”‚
β”β”€β”€ main_custom_ex.cpp    # μ¶”κ°€ μμ  νμΌ: μ»¤μ¤ν…€ HTTP μ„λ²„ μ„¤μ • μμ  (http_ex.cppμ™€ μ μ‹)
β”‚
β””β”€β”€ pch.h                 # λ―Έλ¦¬ μ»΄νμΌλ ν—¤λ” νμΌ (κ³µν†µ ν—¤λ”)

```

<br>

## κΈ°λ³Έ Sample μ½”λ“: `http_ex.cpp` λ¶„μ„

`http_ex.cpp`μ€ ACLμ—μ„ μ κ³µν•λ” HTTP λ¨λ“μ„ ν™μ©ν• κΈ°λ³Έμ μΈ μμ‹ μ½”λ“μ…λ‹λ‹¤. μ΄ μ½”λ“μ—μ„λ” ACL C++ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ HTTP μ„λ²„λ¥Ό μ„¤μ •ν•κ³  μ‹¤ν–‰ν•λ” λ°©λ²•μ„ λ³΄μ—¬μ¤λ‹λ‹¤.



<br>


## μ½”λ“ κµ¬μ„± μ”μ†

```cpp
#include "acl_cpp/lib_acl.hpp"  // Must before http_server.hpp
#include "fiber/http_server.hpp"
```
- **`acl_cpp/lib_acl.hpp`**: ACL C++ λΌμ΄λΈλ¬λ¦¬μ κΈ°λ³Έ ν—¤λ”μ…λ‹λ‹¤. λ‹¤μ–‘ν• λ„¤νΈμ›ν‚Ή, νμΌ μ²λ¦¬, λ¬Έμμ—΄ μ²λ¦¬ κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.
- **`fiber/http_server.hpp`**: HTTP μ„λ²„λ¥Ό κµ¬μ„±ν•λ” λ° ν•„μ”ν• ν΄λμ¤λ¥Ό μ •μν•©λ‹λ‹¤.

```cpp
static char* var_cfg_debug_msg;
static acl::master_str_tbl var_conf_str_tab[] = {
  { "debug_msg", "test_msg", &var_cfg_debug_msg },
  { 0, 0, 0 }
};

static int var_cfg_io_timeout;
static acl::master_int_tbl var_conf_int_tab[] = {
  { "io_timeout", 120, &var_cfg_io_timeout, 0, 0 },
  { 0, 0 , 0 , 0, 0 }
};
```
- **μ„¤μ • λ³€μ μ΄κΈ°ν™”**: `var_cfg_debug_msg`μ™€ `var_cfg_io_timeout`μ€ μ„λ²„ μ„¤μ • κ°’μ„ μ €μ¥ν•λ” λ³€μμ…λ‹λ‹¤. μ΄λ“¤μ€ `acl::master_str_tbl` λ° `acl::master_int_tbl` κµ¬μ΅°μ²΄ λ°°μ—΄μ„ ν†µν•΄ μ„λ²„ μ„¤μ • μ‹ μ‚¬μ©λ©λ‹λ‹¤.

```cpp
int main() {
    const char* addr = "0.0.0.0|8194";
    const char* conf = NULL;

    acl::acl_cpp_init();

    acl::http_server server;

    server.set_cfg_int(var_conf_int_tab).set_cfg_str(var_conf_str_tab);
```
- **μ„λ²„ μ΄κΈ°ν™”**: `acl_cpp_init()`μ„ ν†µν•΄ ACL λΌμ΄λΈλ¬λ¦¬λ¥Ό μ΄κΈ°ν™”ν•κ³ , `http_server` κ°μ²΄λ¥Ό μƒμ„±ν•μ—¬ μ„¤μ •μ„ μ μ©ν•©λ‹λ‹¤.
- **`addr`**: μ„λ²„κ°€ λ°”μΈλ”©ν•  IP μ£Όμ†μ™€ ν¬νΈλ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤.

<br>


## μ΄λ²¤νΈ ν•Έλ“¤λ¬ μ„¤μ •

```cpp
    server.on_proc_init([&addr] {
        std::print("---> after process init: addr={}, io_timeout={}\n", addr, var_cfg_io_timeout);
    }).on_proc_exit([] {
        std::print("---> before process exit\n");
    }).on_proc_sighup([](acl::string& s) {
        s = "+ok";
        std::print("---> process got sighup\n");
        return true;
    }).on_thread_accept([](acl::socket_stream& conn) {
        std::print("---> accept {}\n", conn.sock_handle());
        return true;
    })
```
- **μ΄λ²¤νΈ ν•Έλ“¤λ¬ λ“±λ΅**: μ„λ²„μ μλ… μ£ΌκΈ° λ™μ• νΉμ • μ΄λ²¤νΈκ°€ λ°μƒν•  λ• νΈμ¶λλ” ν•Έλ“¤λ¬λ“¤μ„ μ„¤μ •ν•©λ‹λ‹¤.
  - `on_proc_init`: μ„λ²„ ν”„λ΅μ„Έμ¤κ°€ μ΄κΈ°ν™”λ ν›„ νΈμ¶λ©λ‹λ‹¤.
    + μ„λ²„ μ„¤μ •μ„ ν™•μΈν•κ±°λ‚ μ΄κΈ° μƒνƒλ¥Ό μ¶λ ¥ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.
  - `on_proc_exit`: μ„λ²„ ν”„λ΅μ„Έμ¤κ°€ μΆ…λ£λκΈ° μ „μ— νΈμ¶λ©λ‹λ‹¤.
    + μΆ…λ£ μ§μ „μ— ν•„μ”ν• μ •λ¦¬ μ‘μ—…μ„ μν–‰ν•©λ‹λ‹¤.
  - `on_proc_sighup`: `SIGHUP` μ‹κ·Έλ„μ„ μμ‹ ν–μ„ λ• νΈμ¶λ©λ‹λ‹¤.
    + λ³΄ν†µ μ„¤μ •μ„ λ‹¤μ‹ λ΅λ“ν•κ±°λ‚ μ„λ²„λ¥Ό μ¬μ‹μ‘ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.
  - `on_thread_accept`: ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ΄ μλ½λμ—μ„ λ• νΈμ¶λ©λ‹λ‹¤.
    + μ΄λ• μλ½λ μ—°κ²°μ— λ€ν•΄ μ¶”κ°€μ μΈ μ„¤μ •μ΄λ‚ μ΄κΈ°ν™” μ‘μ—…μ„ μν–‰ν•  μ μμµλ‹λ‹¤.

<br>


## HTTP μ”μ²­ μ²λ¦¬ ν•Έλ“¤λ¬

```cpp
    .Get("/", [](acl::HttpRequest&, acl::HttpResponse& res) {
        std::string buf("hello world1!\r\n");
        res.setContentLength(buf.size());
        return res.write(buf.c_str(), buf.size());
    }).Post("/json", [](acl::HttpRequest& req, acl::HttpResponse& res) {
        acl::json* json = req.getJson();
        if (json) {
            return res.write(*json);
        } else {
            std::string buf = "no json got\r\n";
            res.setContentLength(buf.size());
            return res.write(buf.c_str(), buf.size());
        }
    })
```
- **HTTP μ”μ²­ ν•Έλ“¤λ¬ λ“±λ΅**: GET λ° POST μ”μ²­μ— λ€ν• ν•Έλ“¤λ¬λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.
  - `Get("/")`: λ£¨νΈ κ²½λ΅λ΅ GET μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ "hello world1!" λ©”μ‹μ§€λ¥Ό λ°ν™ν•©λ‹λ‹¤.
  - `Post("/json")`: "/json" κ²½λ΅λ΅ POST μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ JSON λ°μ΄ν„°λ¥Ό μ²λ¦¬ν•κ³  λ°ν™ν•©λ‹λ‹¤.

<br>


## μ„λ²„ μ‹¤ν–‰

```cpp
    .run_alone(addr, conf);

    return 0;
}
```
- **`run_alone`**: μ„λ²„λ¥Ό μ§€μ •λ μ£Όμ†μ™€ ν¬νΈμ—μ„ λ‹¨λ… μ‹¤ν–‰ν•©λ‹λ‹¤. μ΄ λ©”μ„λ“λ” μ„λ²„λ¥Ό λΉ„λ™κΈ°λ΅ μ‹¤ν–‰ν•λ©°, ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•λ” λ©”μΈ λ£¨ν”„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

<br>


## λΉ„λ™κΈ° μ²λ¦¬ λ° μ½”λ£¨ν‹΄

`master_fiber` ν΄λμ¤μ™€ μ΄λ¥Ό μƒμ†λ°›μ€ `http_server_impl` ν΄λμ¤λ” λΉ„λ™κΈ° μ²λ¦¬ λ° μ½”λ£¨ν‹΄μ„ ν†µν•΄ μ„λ²„κ°€ λ‹¤μμ ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ λ™μ‹μ— μ²λ¦¬ν•  μ μλ„λ΅ μ„¤κ³„λμ—μµλ‹λ‹¤. μ΄ κµ¬μ΅°λ” λ‹¤μκ³Ό κ°™μ΄ λ™μ‘ν•©λ‹λ‹¤:

1. **ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½ (`on_accept`)**:
   - ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ λΉ„λ™κΈ°μ μΌλ΅ μλ½ν•κ³ , `http_servlet` κ°μ²΄λ¥Ό ν†µν•΄ κ° μ”μ²­μ„ μ²λ¦¬ν•©λ‹λ‹¤.
   
2. **HTTP μ”μ²­ μ²λ¦¬ (`http_servlet::doRun`)**:
   - κ° μ”μ²­μ„ λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ν•λ©°, μ½”λ£¨ν‹΄μ„ ν™μ©ν•μ—¬ I/O μ‘μ—… μ¤‘μ—λ„ λ‹¤λ¥Έ μ”μ²­μ„ μ²λ¦¬ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

3. **μ„λ²„ μ‹¤ν–‰ νλ¦„**:
   - `run_alone` β†’ `run` β†’ `acl_fiber_server_main` β†’ `service_on_accept` β†’ `http_servlet::doRun`μ μμ„λ΅ μ„λ²„κ°€ λΉ„λ™κΈ°μ μΌλ΅ μ‹¤ν–‰λ©λ‹λ‹¤.
  


  
  ### 3.1 `run_alone` ν•¨μ

  `run_alone` ν•¨μλ” μ„λ²„ μ‹¤ν–‰μ„ μ„ν• μ¤€λΉ„λ¥Ό λ§μΉ ν›„, `run` ν•¨μλ¥Ό νΈμ¶ν•μ—¬ μ„λ²„μ λΉ„λ™κΈ° μ‹¤ν–‰ λ£¨ν”„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.
  
  ```cpp
  bool master_fiber::run_alone(const char* addrs, const char* path /* = NULL */) {
      int argc = 0;
      const char *argv[9];
      const char *file_path = acl_process_path();
      argv[argc++] = file_path ? file_path : "unknown";
      argv[argc++] = "-L";
      argv[argc++] = addrs;
      if (path && *path) {
          argv[argc++] = "-f";
          argv[argc++] = path;
      }
  
      // λΉ„λ™κΈ° μ„λ²„ μ‹¤ν–‰μ„ μ‹μ‘
      run(argc, (char **) argv);
      return true;
  }
  ```

  - **μ„¤λ…**: μ΄ ν•¨μλ” μ„λ²„λ¥Ό μ‹¤ν–‰ν•κΈ° μ„ν• μ„¤μ •μ„ κµ¬μ„±ν•κ³ , `run` ν•¨μλ¥Ό νΈμ¶ν•μ—¬ μ„λ²„μ λΉ„λ™κΈ° μ‹¤ν–‰μ„ μ‹μ‘ν•©λ‹λ‹¤.

  ### 3.2 `run` ν•¨μ

  `run` ν•¨μλ” `acl_fiber_server_main`μ„ νΈμ¶ν•μ—¬ μ„λ²„μ λ©”μΈ λΉ„λ™κΈ° λ£¨ν”„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.
  
  ```cpp
  void master_fiber::run(int argc, char** argv) {
      // μ„λ²„μ λ©”μΈ λΉ„λ™κΈ° λ£¨ν”„ μ‹μ‘
      acl_fiber_server_main(argc, argv, service_on_accept, this,
          /* ... λ‹¤μ–‘ν• μ½λ°± ν•¨μλ“¤ ... */);
  }
  ```
  
  - **μ„¤λ…**: `run` ν•¨μλ” `acl_fiber_server_main`μ„ νΈμ¶ν•μ—¬ μ„λ²„ μ‹¤ν–‰μ μ¤‘μ‹¬μ΄ λλ” μ΄λ²¤νΈ λ£¨ν”„λ¥Ό μ„¤μ •ν•©λ‹λ‹¤. μ΄ λ£¨ν”„λ” ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ν•  μ¤€λΉ„λ¥Ό ν•©λ‹λ‹¤.
  
  ### 3.3 `acl_fiber_server_main` ν•¨μ
  
  μ΄ ν•¨μλ” μ„λ²„μ λ©”μΈ μ΄λ²¤νΈ λ£¨ν”„λ¥Ό μ„¤μ •ν•κ³ , λΉ„λ™κΈ° μ„λ²„ μ‹¤ν–‰μ„ μ„ν• μ¤€λΉ„λ¥Ό ν•©λ‹λ‹¤.
  
  ```cpp
  void acl_fiber_server_main(int argc, char *argv[],
      void (*service)(void*, ACL_VSTREAM*), void *ctx, int name, ...) {
      // μ„λ²„μ μ΄λ²¤νΈ λ£¨ν”„λ¥Ό μ‹μ‘
      servers_start(__servers, acl_var_fiber_threads);
  }
  ```
  
  - **μ„¤λ…**: `acl_fiber_server_main` ν•¨μλ” μ„λ²„μ λΉ„λ™κΈ° μ‹¤ν–‰μ„ μ„ν• λ©”μΈ μ΄λ²¤νΈ λ£¨ν”„λ¥Ό μ„¤μ •ν•κ³ , μ—¬λ¬ μ¤λ λ“ λλ” μ½”λ£¨ν‹΄μ—μ„ ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ μ²λ¦¬ν•  μ μλ„λ΅ μ¤€λΉ„ν•©λ‹λ‹¤.
  
  ### 3.4 ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½ (`service_on_accept` ν•¨μ)
  
  ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ΄ μλ½λ  λ•, `service_on_accept` ν•¨μκ°€ νΈμ¶λμ–΄ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ μ²λ¦¬ν•©λ‹λ‹¤.
  
  ```cpp
  void master_fiber::service_on_accept(void* ctx, ACL_VSTREAM *client) {
      master_fiber* mf = (master_fiber *) ctx;
      acl_assert(mf != NULL);
  
      socket_stream* stream = new socket_stream;
      if (!stream->open(client)) {
          logger_error("open stream error(%s)", acl_last_serror());
          delete stream;
          return;
      }
  
      // ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ μ²λ¦¬
      mf->on_accept(*stream);
      stream->unbind(); // μ—°κ²°μ„ unbind ν•μ—¬ μ†μΌ“ μ¤νΈλ¦Όμ„ λ” μ΄μƒ μ°Έμ΅°ν•μ§€ μ•κ² ν•¨
      delete stream; // μ†μΌ“ μ¤νΈλ¦Ό κ°μ²΄λ¥Ό μ‚­μ ν•μ—¬ μμ›μ„ ν•΄μ 
  }
  ```
  
  - **μ„¤λ…**:
    + μ΄ ν•¨μλ” μƒλ΅μ΄ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ΄ λ°μƒν•  λ• νΈμ¶λ©λ‹λ‹¤.
    + `socket_stream` κ°μ²΄λ¥Ό μƒμ„±ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ μ²λ¦¬ν•κ³ , ν•΄λ‹Ή κ°μ²΄λ¥Ό `on_accept` λ©”μ„λ“μ— μ „λ‹¬ν•μ—¬ λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤.
  
  ### 3.5 ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μ²λ¦¬ (`on_accept` ν•¨μ)
  
  `on_accept` ν•¨μλ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•κΈ° μ„ν•΄ `http_servlet` κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ”μ²­μ„ μ²λ¦¬ν•λ” λ£¨ν”„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
  
  ```cpp
  void master_fiber::on_accept(socket_stream& conn) {
      acl::session* session = new memcache_session("127.0.0.1|11211");
      http_servlet servlet(handlers_, &conn, session);
      servlet.setLocalCharset("utf-8");
  
      // HTTP μ”μ²­μ„ μ²λ¦¬
      while (servlet.doRun()) {}
  
      delete session;
  }
  ```
  
  - **μ„¤λ…**:
    + `on_accept` ν•¨μλ” ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ μ²λ¦¬ν•λ” ν•µμ‹¬ ν•¨μμ…λ‹λ‹¤.
    + κ° ν΄λΌμ΄μ–ΈνΈμ— λ€ν•΄ λ…λ¦½μ μΈ `http_servlet` κ°μ²΄κ°€ μƒμ„±λλ©°, μ΄ κ°μ²΄κ°€ μ”μ²­μ„ μ²λ¦¬ν•©λ‹λ‹¤. μ΄λ¥Ό λΉ„λ™κΈ°μ μΌλ΅ κ΄€λ¦¬ν•©λ‹λ‹¤.
  
  ### 3.6 HTTP μ”μ²­ μ²λ¦¬ (`http_servlet::doRun` ν•¨μ)
  
  `http_servlet::doRun` ν•¨μλ” μ‹¤μ λ΅ HTTP μ”μ²­μ„ μ²λ¦¬ν•κ³ , ν΄λΌμ΄μ–ΈνΈμ—κ² μ‘λ‹µμ„ μ „μ†΅ν•©λ‹λ‹¤.
  
  ```cpp
  bool http_servlet::doRun() {
      acl::HttpRequest request;
      acl::HttpResponse response;
  
      if (parseRequest(request) && handlers_[request.getMethod()][request.getPath()]) {
          handlers_[request.getMethod()][request.getPath()](request, response);
      }
  
      response.send(conn_);
      return conn_->keep_alive();
  }
  ```
  
  - **μ„¤λ…**:
    + `doRun` λ©”μ„λ“λ” HTTP μ”μ²­μ„ μ²λ¦¬ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.
    + μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ μ΄λ¥Ό νμ‹±ν•κ³ , ν•΄λ‹Ή μ”μ²­μ— λ§λ” ν•Έλ“¤λ¬λ¥Ό μ‹¤ν–‰ν•μ—¬ μ‘λ‹µμ„ μƒμ„±ν•©λ‹λ‹¤.
    + μƒμ„±ν• μ‘λ‹µμ€ send λ©”μ„λ“λ¥Ό ν†µν•΄ ν΄λΌμ΄μ–ΈνΈλ΅ μ „μ†΅λ©λ‹λ‹¤.
  
## 4. λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ν•λ” μ„λ²„μ μ „μ²΄ νλ¦„ μ”μ•½


1. **`run_alone`**: μ„λ²„ μ‹¤ν–‰ μ¤€λΉ„ λ° λΉ„λ™κΈ° μ‹¤ν–‰ μ‹μ‘.
2. **`run`**: μ„λ²„μ λ©”μΈ λΉ„λ™κΈ° λ£¨ν”„ μ‹μ‘.
3. **`acl_fiber_server_main`**: μ„λ²„μ λΉ„λ™κΈ° μ΄λ²¤νΈ λ£¨ν”„ μ„¤μ •.
4. **`service_on_accept`**: ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½ λ° λΉ„λ™κΈ° μ²λ¦¬ μ¤€λΉ„.
5. **`on_accept`**: ν΄λΌμ΄μ–ΈνΈμ HTTP μ”μ²­ μ²λ¦¬ μ‹μ‘.
6. **`http_servlet::doRun`**: HTTP μ”μ²­μ„ λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ν•κ³ , ν΄λΌμ΄μ–ΈνΈμ—κ² μ‘λ‹µ μ „μ†΅.

μ΄ μ „μ²΄ κ³Όμ •μ—μ„ μ½”λ£¨ν‹΄μ„ ν†µν•΄ μ„λ²„λ” λ‹¤μμ ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ λ™μ‹μ— μ²λ¦¬ν•  μ μμΌλ©°, I/O μ‘μ—… μ¤‘μ—λ„ λ‹¤λ¥Έ μ”μ²­μ„ μ²λ¦¬ν•  μ μλ” κµ¬μ΅°λ¥Ό κ°–μ¶”κ² λ©λ‹λ‹¤.
  
<br>


## λ¦¬ν©ν† λ§

### HTTP μ½”λ“ κµ¬μ΅° λ¶„λ¦¬

- HTTP μ„λ²„ μ½”λ“λ¥Ό `controller`, `service`, `model`λ΅ λ¶„λ¦¬ν•μ—¬ μ½”λ“μ μ—­ν• μ„ λ…ν™•ν•κ² κµ¬λ¶„ν–μµλ‹λ‹¤. 
- μ΄λ¬ν• κµ¬μ΅°λ” μ½”λ“μ μ μ§€ λ³΄μμ„±κ³Ό ν™•μ¥μ„±μ„ λ†’μ΄λ” λ° κΈ°μ—¬ν•λ©°, κ° λ μ΄μ–΄κ°€ κ³ μ ν• μ±…μ„μ„ κ°€μ§€λ„λ΅ μ„¤κ³„λμ—μµλ‹λ‹¤.

#### 1. **Controller (http_controller.hpp)**
Controllerλ” HTTP μ”μ²­μ„ μ²λ¦¬ν•κ³ , μ„λΉ„μ¤ λ μ΄μ–΄λ¥Ό νΈμ¶ν•μ—¬ μ μ ν• μ‘λ‹µμ„ λ°ν™ν•λ” μ—­ν• μ„ ν•©λ‹λ‹¤. μ΄ λ μ΄μ–΄λ” ν΄λΌμ΄μ–ΈνΈμ™€ μ§μ ‘ μƒνΈμ‘μ©ν•λ©°, κ²½λ΅(route)λ¥Ό μ •μν•κ³  κ° κ²½λ΅μ— λ€ν• μ”μ²­μ„ μ²λ¦¬ν•©λ‹λ‹¤.


#### 2. **Service (http_service.hpp)**
Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μ²λ¦¬ν•©λ‹λ‹¤. μ΄ λ μ΄μ–΄λ” μ»¨νΈλ΅¤λ¬μ—μ„ νΈμ¶λλ©°, μ”μ²­μ— λ€ν• λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μ²λ¦¬ν•κ±°λ‚ ν•„μ”ν• κ²½μ° λ°μ΄ν„° λ¨λΈμ— μ ‘κ·Όν•©λ‹λ‹¤.


#### 3. **Model (http_model.hpp)**
Modelμ€ λ°μ΄ν„° κµ¬μ΅°μ™€ λ°μ΄ν„°λ² μ΄μ¤ λλ” μ™Έλ¶€ APIμ™€μ μƒνΈμ‘μ©μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤. ν„μ¬ ν”„λ΅μ νΈμ—μ„λ” λ°μ΄ν„°λ² μ΄μ¤μ™€μ μ§μ ‘μ μΈ μƒνΈμ‘μ©μ΄ μ—†μ§€λ§, ν•„μ”μ— λ”°λΌ μ΄ λ μ΄μ–΄μ—μ„ λ°μ΄ν„° κµ¬μ΅°λ¥Ό μ •μν•κ³  μ„λΉ„μ¤ λ μ΄μ–΄μ—μ„ μ΄λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.


#### 4. **Main (main.cpp)**
Main νμΌμ€ μ„λ²„ μ„¤μ • λ° λΌμ°ν…μ„ μ΄κΈ°ν™”ν•κ³ , μ„λ²„ μ‹¤ν–‰μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤. 
μ΄ νμΌμ€ HTTP μ„λ²„μ μ§„μ…μ μΌλ΅, μ„λ²„λ¥Ό μ„¤μ •ν•κ³  κ° κ²½λ΅μ— λ€ν• μ»¨νΈλ΅¤λ¬λ¥Ό λ“±λ΅ν•©λ‹λ‹¤.


<br>

### C++23 κΈ°λ¥ ν™μ©

#### std::printλ΅ μ¶λ ¥ λ©”μ‹μ§€ κ°μ„ 
κΈ°μ΅΄μ printf λ° std::coutμ„ std::printλ΅ λ€μ²΄ν•μ—¬, μ¶λ ¥ λ©”μ‹μ§€λ¥Ό κ°„κ²°ν•κ² ν‘ν„ν–μµλ‹λ‹¤.


<br>


## κ²°λ΅ 

- μ΄ μ½”λ“μ—μ„μ λΉ„λ™κΈ° μ²λ¦¬μ ν•µμ‹¬μ€ **μ½”λ£¨ν‹΄**μ„ ν†µν• **λΉ„λ™κΈ° I/O**μ…λ‹λ‹¤. 
  + `run_alone` ν•¨μμ—μ„ μ‹μ‘λ λΉ„λ™κΈ° μ„λ²„ μ‹¤ν–‰μ€ ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½κ³Ό μ”μ²­ μ²λ¦¬μ—μ„ μ½”λ£¨ν‹΄μ„ μ‚¬μ©ν•μ—¬ λ‹¤μμ μ”μ²­μ„ λ™μ‹μ— μ²λ¦¬ν•  μ μκ² ν•©λ‹λ‹¤. 
  + μ΄λ΅ μΈν•΄ μ„λ²„λ” λ†’μ€ μ„±λ¥μ„ μ μ§€ν•λ©°, μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ™μ‹μ— μ²λ¦¬ν•  μ μμµλ‹λ‹¤.

<br>


## μ°Έκ³  λ¬Έμ„

- **[π“„Acl HTTP Server κΈ°λ¥ μ •λ¦¬](../Document/Acl-HTTP-Server.md)**: ACLμ HTTP λ¨λ“μ— λ€ν• λ” μμ„Έν• κΈ°λ¥κ³Ό μ‚¬μ©λ²•μ„ λ‹¤λ£¨κ³  μμµλ‹λ‹¤.

